<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A humble mocking library for Kotlin, KotlinJS and Kotlin Multiplatform using Kotlin Symbol Processing (KSP)."><meta name=author content="Matthias Geisler"><link href=https://bitpogo.github.io/kmock/unspecified/howto/annotations/ rel=canonical><link href=../terminology/ rel=prev><link href=../proxy/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.10"><title>Declaring a Mock - KMock</title><link rel=stylesheet href=../../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../assets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=indigo data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#declaring-a-mock class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=KMock class="md-header__button md-logo" aria-label=KMock data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> KMock </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Declaring a Mock </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=indigo data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/bitPogo/kmock title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> bitPogo/kmock </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=KMock class="md-nav__button md-logo" aria-label=KMock data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> KMock </label> <div class=md-nav__source> <a href=https://github.com/bitPogo/kmock title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> bitPogo/kmock </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../quickstart/ class=md-nav__link> <span class=md-ellipsis> Quickstart </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/ class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../../concept/ class=md-nav__link> <span class=md-ellipsis> Concept </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> How To </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> How To </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../install/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../setup/ class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> </li> <li class=md-nav__item> <a href=../terminology/ class=md-nav__link> <span class=md-ellipsis> Terminology </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Declaring a Mock </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Declaring a Mock </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#build-in-annotations class=md-nav__link> <span class=md-ellipsis> Build-In Annotations </span> </a> <nav class=md-nav aria-label="Build-In Annotations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#single-interface-mocks class=md-nav__link> <span class=md-ellipsis> Single Interface Mocks </span> </a> </li> <li class=md-nav__item> <a href=#multi-interface-mocks class=md-nav__link> <span class=md-ellipsis> Multi Interface Mocks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-annotations class=md-nav__link> <span class=md-ellipsis> Custom Annotations </span> </a> </li> <li class=md-nav__item> <a href=#experimental-annotations class=md-nav__link> <span class=md-ellipsis> Experimental Annotations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../proxy/ class=md-nav__link> <span class=md-ellipsis> Using Mocks </span> </a> </li> <li class=md-nav__item> <a href=../assertion/ class=md-nav__link> <span class=md-ellipsis> Assertion/Verification </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/code-of-conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../development/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../development/releasing/ class=md-nav__link> <span class=md-ellipsis> Releasing </span> </a> </li> <li class=md-nav__item> <a href=../../development/badges/ class=md-nav__link> <span class=md-ellipsis> Badges </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../migration/ class=md-nav__link> <span class=md-ellipsis> Migration Guide </span> </a> </li> <li class=md-nav__item> <a href=../../security/ class=md-nav__link> <span class=md-ellipsis> Security Policy </span> </a> </li> <li class=md-nav__item> <a href=../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#build-in-annotations class=md-nav__link> <span class=md-ellipsis> Build-In Annotations </span> </a> <nav class=md-nav aria-label="Build-In Annotations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#single-interface-mocks class=md-nav__link> <span class=md-ellipsis> Single Interface Mocks </span> </a> </li> <li class=md-nav__item> <a href=#multi-interface-mocks class=md-nav__link> <span class=md-ellipsis> Multi Interface Mocks </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-annotations class=md-nav__link> <span class=md-ellipsis> Custom Annotations </span> </a> </li> <li class=md-nav__item> <a href=#experimental-annotations class=md-nav__link> <span class=md-ellipsis> Experimental Annotations </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=declaring-a-mock>Declaring a Mock<a class=headerlink href=#declaring-a-mock title="Permanent link">&para;</a></h1> <p>To declare Mocks you have to use KMock's annotations or those you have declared in the KMock's Gradle Extension. You can declare Mocks in a central place (per platform) or per test suite. However declaring them in a central place is discouraged since it violates the <a href=https://enterprisecraftsmanship.com/posts/dry-damp-unit-tests/ >DAMP unit tests</a> principle.</p> <h2 id=build-in-annotations>Build-In Annotations<a class=headerlink href=#build-in-annotations title="Permanent link">&para;</a></h2> <p>KMock offers you 6 annotations which are considered as stable to declare a Mock:</p> <ul> <li>Mock/MultiMock for Platform specific Mocks,</li> <li>MockShared/MultiMockShared for Shared Sources (like native),</li> <li>MockCommon/MultiMockCommon for commonTest.</li> </ul> <h3 id=single-interface-mocks>Single Interface Mocks<a class=headerlink href=#single-interface-mocks title="Permanent link">&para;</a></h3> <p>Declaring a Mock for common or platforms works alike. Mock/MockCommon takes an arbitrary amount of interfaces which will used as Templates to generate Mocks of: <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>tech.antibytes.kmock.MockCommon</span>

<span class=nd>@MockCommon</span><span class=p>(</span>
<span class=w>   </span><span class=n>SampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>   </span><span class=n>OtherSampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>   </span><span class=p>...</span>
<span class=p>)</span>
<span class=kd>class</span><span class=w> </span><span class=nc>SampleTestSet</span><span class=w> </span><span class=p>{</span>
<span class=w>   </span><span class=p>...</span>
<span class=p>}</span>
</code></pre></div></p> <p>MockShared takes an additional argument <code>sourceSetName</code> in order to associate the Templates with the Shared Source Set like <code>iosTest</code>. You can also use only a short reference instead of the full name (e.g. long: <code>iosTest</code>, short: <code>ios</code>): <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>tech.antibytes.kmock.MockShared</span>

<span class=nd>@MockShared</span><span class=p>(</span>
<span class=w>   </span><span class=s>&quot;native&quot;</span><span class=p>,</span>
<span class=w>   </span><span class=n>SampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>   </span><span class=n>OtherSampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>   </span><span class=p>...</span>
<span class=p>)</span>
<span class=kd>class</span><span class=w> </span><span class=nc>SampleTestSet</span><span class=w> </span><span class=p>{</span>
<span class=w>   </span><span class=p>...</span>
<span class=p>}</span>
</code></pre></div></p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>You do not have to mix those Annotations per test set. KMock is totally fine if you declare a Template in one source as common and in another source as platform source. It will resolve any conflicts according to their precedence in Kotlin's hierarchical source sets. As a rule of thumb - you need for Single Interface Mocks one Annotation per test set.</p> </div> <h3 id=multi-interface-mocks>Multi Interface Mocks<a class=headerlink href=#multi-interface-mocks title="Permanent link">&para;</a></h3> <p>KMock is also capable of generate Mocks based on multiple interfaces. Similar to Single Interface Mocks, MultiMock and MultiMockCommon can declare Mocks in the very similar way: <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>tech.antibytes.kmock.MultiMockCommon</span>

<span class=nd>@MultiMockCommon</span><span class=p>(</span>
<span class=w>    </span><span class=s>&quot;MergedCommon&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=n>SampleDomainObject</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>    </span><span class=n>ExampleContract</span><span class=p>.</span><span class=na>DecoderFactory</span><span class=o>::</span><span class=kd>class</span>
<span class=err>)</span>
<span class=kd>class</span><span class=w> </span><span class=nc>SampleTestSet</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=p>...</span>
<span class=p>}</span>
</code></pre></div> In difference to Single Interface Mocks, Multi Interface Mocks Annotations can be applied multiple times per test set. Also all Multi Interface Mocks Annotations need an additional argument <code>name</code> which will be used as name for the generated Mock. All referenced Interfaces will then be merged into one Mock. As with Single Interface Mocks, the Annotation for Shared Sources needs an additional argument <code>sourceSetName</code> to bind the generated Mock to a source set: <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>tech.antibytes.kmock.MultiMockShared</span>

<span class=nd>@MultiMockShared</span><span class=p>(</span>
<span class=w>    </span><span class=n>sourceSetName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;nativeTest&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;MergedShared&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=n>SampleDomainObject</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>    </span><span class=n>ExampleContract</span><span class=p>.</span><span class=na>DecoderFactory</span><span class=o>::</span><span class=kd>class</span>
<span class=err>)</span>
<span class=kd>class</span><span class=w> </span><span class=nc>SampleTestSet</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=p>...</span>
<span class=p>}</span>
</code></pre></div></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Do not use this feature to create one Mock for all tests. It was never intended for that.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Even if it is not directly intended you can use Multi-Interface Annotations to produce Aliases for Single-Interface Mocks.</p> </div> <h2 id=custom-annotations>Custom Annotations<a class=headerlink href=#custom-annotations title="Permanent link">&para;</a></h2> <p>You can also use your custom Annotations in order to ease the handling with Shared Sources. Your Annotations are not allowed to reference common and have to take a arbitrary amount of KClass (aka vararg) for Single Interface Mocks. For Multi Interface Mocks your Annotations have to take as the very first argument a String additionally to the KClasses: <div class=highlight><pre><span></span><code><span class=k>package</span><span class=w> </span><span class=nn>my.package</span>

<span class=nd>@Retention</span><span class=p>(</span><span class=n>AnnotationRetention</span><span class=p>.</span><span class=na>SOURCE</span><span class=p>)</span>
<span class=nd>@Target</span><span class=p>(</span><span class=n>AnnotationTarget</span><span class=p>.</span><span class=na>CLASS</span><span class=p>)</span>
<span class=nd>@MustBeDocumented</span>
<span class=kd>annotation</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>Custom</span><span class=p>(</span><span class=k>vararg</span><span class=w> </span><span class=kd>val</span><span class=w> </span><span class=nv>interfaces</span><span class=p>:</span><span class=w> </span><span class=n>KClass</span><span class=o>&lt;*&gt;</span><span class=p>)</span>

<span class=nd>@Repeatable</span>
<span class=nd>@Retention</span><span class=p>(</span><span class=n>AnnotationRetention</span><span class=p>.</span><span class=na>SOURCE</span><span class=p>)</span>
<span class=nd>@Target</span><span class=p>(</span><span class=n>AnnotationTarget</span><span class=p>.</span><span class=na>CLASS</span><span class=p>)</span>
<span class=nd>@MustBeDocumented</span>
<span class=kd>annotation</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>MultiCustom</span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>name</span><span class=p>:</span><span class=w> </span><span class=kt>String</span><span class=p>,</span><span class=w> </span><span class=k>vararg</span><span class=w> </span><span class=kd>val</span><span class=w> </span><span class=nv>interfaces</span><span class=p>:</span><span class=w> </span><span class=n>KClass</span><span class=o>&lt;*&gt;</span><span class=p>)</span>
</code></pre></div></p> <h2 id=experimental-annotations>Experimental Annotations<a class=headerlink href=#experimental-annotations title="Permanent link">&para;</a></h2> <p>With 0.2.0 KMock offers 2 new experimental Annotations - <code>KMock</code> and <code>KMockMulti</code> which lift the need of telling KMock to which Source Set a Mock binds. Those Annotations will determine the Source Set of a Mock based on the contexts they are declared. However those Annotations are considers as experimental since there might be edge cases which are not covered by them. They can be used in the exact same way as <code>Mock</code> or <code>MockMulti</code>: <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>tech.antibytes.kmock.MultiMockShared</span>

<span class=nd>@KMock</span><span class=p>(</span>
<span class=w>    </span><span class=n>SampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>    </span><span class=n>OtherSampleInterface</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>    </span><span class=p>...</span>
<span class=p>)</span>
<span class=nd>@KMockMulti</span><span class=p>(</span>
<span class=w>    </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;MergedShared&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=n>SampleDomainObject</span><span class=o>::</span><span class=n>class</span><span class=p>,</span>
<span class=w>    </span><span class=n>ExampleContract</span><span class=p>.</span><span class=na>DecoderFactory</span><span class=o>::</span><span class=kd>class</span>
<span class=err>)</span>
<span class=kd>class</span><span class=w> </span><span class=nc>SampleTestSet</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=p>...</span>
<span class=p>}</span>
</code></pre></div></p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022-2024 Matthias Geisler </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/bitPogo/kmock target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tracking", "navigation.top"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.8fd75fb4.min.js></script> </body> </html>